## 開発計画
**現在目標**
フェードインのタイムとフェード開始のdelayを短時間だがランダムでばらつきかさせる。

サイドオブジェクトのフェードアウト→即フェードインの機構を作って試す。
サイドオブジェクトはでかいままの方がいいのか？

フェードイン中に歩行ボタンが押され、
フェードアウトに飛ぶ処理を考える。
フェードインからフェードアウトの間に、**接近回数**を重ねる。
- だからフェードイン中に歩行ボタンを押すと、それは止まり、接近アニメーションにぶつ切りで移る。
- 接近回数はSideMoveスクリプトから指定する。
	- 接近回数=0なら、フェードイン中をキャンセルしてそのままフェードアウトが再生される。(不自然そうだったらやめる)

サイドオブジェクトのシステムを作る。
LEFTとRIGHTそれぞれ空間定義してprefabをgameObjectと結びつける
- litmotionを導入してそれで動かす
	- [モーションの設定 | LitMotion (annulusgames.github.io)](https://annulusgames.github.io/LitMotion/articles/ja/motion-configuration.html)
	- キャンセルされるか次へ行くかでサイドオブジェクトは
	  **こちらに迫ってきつつ、それぞれの左右へ反れる**。
		- その動きはそれぞれのサイドオブジェクトのスクリプトに登録する。
			- イン
				- Startで代用？
				- 始点から終点(Vector2)
				- フェードインの時間(alphaが通常に戻るまでの時間)
				- 回転要素
				- 線の太さの膨らみ？
				- ~~ラインのそれぞれの座標を動かして組み立てる動き~~
					- を考えたけど、それやると既に完成してる都市を歩いてる感無くなるから却下。
			- アウト
				- 始点から中点でこちらへ迫り、中点から終点でそれぞれの左右へ反れる(Vector3)
				- 二段階の回転点
				- フェードアウトの時間
- **ノーマルの状態はエディタで配置**、インとアウトはそのオブジェクトのスクリプトで
  操作する？？
- 全体的な揺れる震度
- デフォルトの位置
	- ランダムである程度範囲を指定？
- 現れる位置(固定？？いや可変の方が探索間でるかも、アニメーション出現エフェクトとかはなくて、ただ普通にフェードインしてくるだけだから。)

その他のマテリアルなどの動く値もLitMotionで置き換える。

味方アイコンは路に対峙するように、
ロードオブジェクトの眼前に上から見下ろしたように配置する
![[Drawing 2024-10-11 05.35.52.excalidraw|200]]

backgroundの
![[penup_20240929_223222.jpg|200]]
みたいな感じの動くタイプのぼんやりした色が浮くようなテクスチャをマテリアルかrebelleで実装する[[]]

<mark style="background: #FFB8EBA6;">ウトナみたいにエンカウント時に、
カメラが寄るようにする、敵以外のbackgroundが。
その為には、カメラ操作とsprite rendererに置き換えるまたはui imageのゴリ押し。なお、ウトナと同じように動く背景にブラーがかかり、色が変化するようにする。（色とかはencount waveとかで代用？）</mark>

EYEAREAで背景を司るスクリプトとオブジェクト設計
- その外側を満たすノイズの海
	- そのノイズから敵が出てくる時の==種別による立ち絵の違い==
		- 生命はフェードイン
		- 機械はそのまま
		- TLOAは半透明のまんま
- 敵の視覚的表現
	- 二種類ある
		- 敵の<mark style="background: #FFF3A3A6;">固定チーム系</mark>か<mark style="background: #ABF7F7A6;">自由系</mark>かでテキストエリアと敵グラの配置関係が変わる。
	- 敵のテキストエリア
		-

敵の固定チームはパーティー属性もそれぞれの属性も固定。
路人は==ロードグラフィックから起き上がるように出てきて、TIMELINEで優先的に処理される。==


![[タイトルなし.png|200]]
エンカウントの波は
**その逆の左右から上から**襲ってくるようにある。
逆にこっちから先手必勝型エンカウントしたら、
押したボタンの**左右の下側からエンカウントの波が飛ぶ**。

エンカウントはnoiseSeaは使うか？？？
- スキル？
- ボスエンカウント??



BattleTIMELINはシングルトン?

![[Drawing 2024-10-04 22.52.55.excalidraw]]


親敵テキストエリアを背景オブジェクトに合わせた三人設定ロジックで
エリア内に適切に設定するロジックのワンパーツとして用いる。




[[敵ステータス枠_241003_023032.pdf]]
敵と味方のバトルアイコンのgameObjectとスクリプト制作。
![[敵のバトルアイコン|900]]
![[ロードオブジェクト|200]]

encountしたら、walkbtnが使えなくなり、
敵のバトルアイコンと味方のバトルアイコンを司るオブジェクトが
trueになって、battlemanagerや、USERUIのボタンと処理が結びついたりする？

敵リストから[[豚岬の戦闘の運び　エンカ基礎1]]を使い、encount関数からの抽象的な
流れを作る

敵のエリアが出てくるとワンテンポ遅れて、敵のパーティー属性の記述が出てくる
ダン、バァン　ッテ感じで　
**その出方はいわゆる非同期で、コマンド操作はエンカウントした瞬間に**
**操作可能**



battlemanagerやtimelineと視覚的に必要なオブジェクトの結びつきを考える。


種別、実態生命のクラス化←これいる？


前のめりを実装するならtanbontrolの_statesを参考に

ポストプロセスでまるでunityremoteを使ってるかのように全体的に低画質化させる。




## ui計画
### 基礎想起
![[豚岬基礎ui.png]]
天気窓はUSERUIのどっかに入れとく。　~~またはskyrainシステムで流す。~~
と思ったがあれは背景をボツらせることで生える心情的ゲームシーンに映える奴であって、
俺の下手な背景の上では絵としての下手さがただ強調されるのみなので、
スカイショットrpgの優秀な天気窓を利用する。
でもやっぱり現在の背景システムの想定だとskyrainでもいけるかも

スキルカテゴリからスキルへの遷移
気力などの画面を　babaisyou のポーズ時の
配置と動き参考に作る。(三人の共通系のステータスとして使用？)
### 内部構成
- AlwaysCanvas
	- 常に動いてるimage等を扱う。
- DynamicCanvas
	- たまに動いたりするuiを扱う。
- ~~StableCnavas~~（<mark style="background: #CACFD9A6;">複雑化するのでDynamicで代用</mark>）
	- 決して動かないようなUIを扱う
- 参考　[【Unity】Canvasでパフォーマンスに関わることについて調べてみた - げぇむぷろぐらみんぐ (hatenablog.com)](https://siguma-sig.hatenablog.com/entry/2018/08/11/095156#%E5%8B%95%E3%81%8FUI%E3%81%A8%E5%8B%95%E3%81%8B%E3%81%AA%E3%81%84UI%E3%81%A7Canvas%E3%82%92%E5%88%86%E3%81%91%E3%82%8B)


## 雑多
ゲームプロセスのページ　→　[[豚岬のプロセス具現]]
pは自然回復する。

トラベラーズシャッフル
天気は精神の属性に影響?---その時の属性の組み合わせの続いた時間などを要素に、
ランダムで天気を変えるメゾット？？

全員のHPが減れば減るほど
それぞれのステータスが上がり、
逃走確率はさがっていく?

### bgm
https://youtu.be/uAXxrS2I4jg?si=_FQPmrzEYdBTnkFN
これずっとループするだけ
==ゲーム中は一切bgmが変わることはない。==(コンフィグから消せるけど。)
ただ、ゲームを開始したときのステージの位置によってBGMが変わるのかもしれない。
この**開始時BGMシステム**はコンフィグによる切り替えでも反応するかもね

[【フリーBGM】ボスバトル 式の継承者【作業用BGM】 - YouTube](https://www.youtube.com/watch?v=fhvnxGYAs3U)
https://audiostock.jp/audio/favorite_list ←<mark style="background: #BBFABBA6;">効果音の一部も</mark>
~~雪道と同じbgmシステムなので、~~
~~ステージ間のストーリーと、実ステージ上でのストーリーはその感情曲線が一致するようにする。~~
~~例: スカイショットがアルテマルフトさんを見て絶望　階段たちは急に放出された世界に驚く~~
### タイトル画面
イカダ漕ぎと同じ　タイトルのみが書かれた画面をタップすると
その画面が同じ効果音で、下から上へとイージングして開く。(イージングじゃなくてもいいかな)
起動するたびに
- パーティーの健康状態
- ストーリーとかステージ、さらにはAreaCut
などの条件でタイトル文字の下に書かれるビジュアルが変わる。
ビジュアルはラフなループアニメーションのが、[[#bgm]]と相性がいいと思う

ステージ名とエリアカットと豚岬か廃都市かどうかがビジュアルの上に、というかタイトル文字の真下に書かれる。
### USRUIとEYEAREA
基本的に動的な動きは全てのEYEAREAに映し、
USRUIはタブメニューが基本で精々キャラのスキルボタンが震えたりする程度。
### 太字ボタン
太字ボタンは周りに点々が薄っすらフェードしつつ回転して押すべき

範囲をプレイヤーに理解させる
### タブ挙動(USERUI)
#### 選ばれてないとき
豚岬のタイトルとクレジットとかイントロとかがボタンである。
例えばステージクリアするたびにタブは選ばれてないことになるので、
ステージ間のストーリー終わってゲーム画面に戻るたびにタブメニューがタイトルに戻ってる感じ

## 歩き(WalkProcess)
基本的にそこから行けるエリアが複数あるならば幾ほどかで分岐があり、　
そのエリアをゴールすることで先に進める。
ボスの範囲内に入り、その状態で[[evilsearh]]を利用すると、先のゴールが解放され、
**ボスは選択することでエンカウントが出来るようになる。**

確定で敵が現れるポイントがある。
システム的にボスのエリアに入るまでの間に存在したりする
### 逆ストーリの可能性
会話などを一切省き、
一歩の地点ごとに逆順のストーリが設定されていて、
最後まで行ってから、戻るボタンが読む、になるのでそれでストーリーが分かる。
この場合ゲーム中の出来事がそのストーリで語ることになるよ
### 逆文字収集
逆文字であり逆ストーリである。
一歩一歩でその変な逆文章を集める
これは[[#パズル]]と関連する？？
この際画像はボスの出る箇所と同期する。
==ならその画像の状況とボスをどうリンクさせるか。==
#### 会話
二種類ある
[[路人]]がエンカウントして戦闘する直前に話しかけてきたり、
マップ上のイベントで話したりする。
**あの世**と同じような途切れ途切れな文字出現音でunitaskで非同期文章

このツイートのような平体から元の
読みやすい文字に戻るようなテキストアニメーションにする。
![](https://twitter.com/120U1/status/1833794496217428015)
##### 汎用的な動的な会話
プログラム上から実行される、色んな瞬間に差し込まれるunitaskとかでの会話。
謎解きというかそういう大事な要素なら聞き逃さないように、
プログラム上のアプローチで何回か救済的に会話されるようにする。
##### 固定会話
電話または無線または看板で、特定のエリアに固定で立っている奴。
#### イベントシステム
各所で汎用的に潜り込む会話システムと違って、ステージを突破するために、
設けられた**イベント門**があって、
そういうのは特定の抽象化した概念のリスト化が必要だと思う。
- アイテムの使用
- アイテムの保持
- 

### 絵
**散開とか誰かの個人戦闘状態**のときとかに離人システムを表現するため、
==アールエス==の暗い画面での動く四角形とか、それを基本とした
少ない要素しか見えないアールエスのような背景絵

遠景の空画像は四隅を開けてもとの背景色を写す感じ
[アナログのようになるから](https://twitter .com/damachitanu/status/1825903775586070748?t=-yfSrjgV2l5RDKL54K25CA&s=19)
#### Canvasのシステム（最適化）
dynamicCanvasとAlwaysCanvasに分けることでuiImageの負荷を下げている。
また、CanvasごとにSpriteAtlasを設定している。
DynamicAtlasにはImageディレクトリのDynamicフォルダを直接渡してアトラス化の管理をunityが自動で行うようになっている。
https://siguma-sig.hatenablog.com/entry/2018/08/11/095156
#### エンカウント
**ボタンは既にある物の文字が遷移なく変更する。**
==糸がこんがらがるアニメーション==がEncountWaveと同時に発生して、
waveが去るころにループアニメーション(敵の)が出てくる感じ
#### 背景の構成

-  上の方に山のような遠景として遠く描かれる単純なディテール
	- これは一種のステージ系UIのようなもので、ステージごとに変わる
- WalkWeb
	- WalkWebをもっとサイドオブジェクトとロードオブジェクトで囲むに値する
<mark style="background: #FF5582A6;">進むべき先</mark>のような感じにする。
==アニメーションせずに手描き風にそのまんまでいいかも。==


普通にゲームの目標としての感じを思わせるようなのが重要。ただでさえ単調なゲームなのだから　キラキラきらんと。
アニメーションさせてもいいと思う。
ものすごいはっきりさせるような感じの。
都市としてのビジュアルなどサイドオブジェクトやロード、上のui枠で再現するから
真ん中の遠くにはだんだん大きくなる目標としてのビジュアルを。。
なお、
- ステージの終わりか
- またはエリアの終わりかで
 目標地点の絵は代わる
	- ![[Drawing 2024-10-07 04.46.36.excalidraw|200]]
- NoiseSea
- EncountWaveが外で待機
	- EncountWaveは灰色で白を埋め尽くすから、==敵の色は白色で描かれる？==
- サイドオブジェクト

#### 敵グラは
- スカイショットrpg式テキスト
- 精神、[[ディノイド]](それ自体が[[TLOAの傾向]]がそうなってるということ。)
#### 敵のアニメーション　エンカウント
登場時　→　ループ→==種別による==あの世のような汎用的な消滅アニメ
被ダメや攻撃などの敵アニメの違いは一切ない
![[#エンカウント]]

弾けるようなアニメーション
ループアニメが出てくると同時に
その背後に種別が文字送りで出てくる。
中央揃えでタイピング風に
また、文字には背景がある。見やすいようにね

#### 豚岬の景色
豚岬の景色は四隅を省いた画像を奥にした例のレイアウトのときに、**初期想起したあの景色をしっかり遠景に描く**  
#### エンカウントのフロー
- エンカウント時にスカイショットrpgとアールエスを混ぜたような絵展開
具体的に言うと図形で満たされた画面が元の背景画像をオーバーレイまたは
元の背景画像そのものをかき混ぜる様なあれ
- 四隅の欠いた遠景からノイズ満たされた周囲園域からモザイクのような効果音と共に出てくるイメージ  。初期の爆発円環のイメージはそれに付随する形で  （モザイクにイメージが引き寄せられる感じで）
#### スキルエフェクト
全体的にlitmotionを用いた
アンディーメンテ式か、
または普通になんかの絵か
#### 敵の攻撃エフェクト
eyearea左下の主人公陣営のちったい四角に
敵のエフェクトは来る、
その**小ささに合わせたミニマムなエフェクトで表現する。**
#### 思え鳥のエフェクト
敵の場合、キャラテキストの近くに概念的下手な絵があるが、
そこにある心っぽい部分の絵にひび割れていく感じ。
味方の場合、四角のミニボックスが割れるだけ(割れ目から
それぞれの鳥が見える)
思え鳥になると、USERUIのmainでの各キャラクターの絵が
それぞれの鳥になる。　派生鳥(サテラ)の絵もある。

#### ~~数字~~による槍展開的なダメージエフェクト
あくまで**あの世**風なテンポで進む話なので、
**このエフェクト表現は後発的な攻撃または**
**そもそも使うとしても超高速で展開される?**
[文俊 さんのノートブック](https://1drv.ms/o/c/0a9d605a6bc4f019/EhnwxGtaYJ0ggAp3WgAAAAABKMDhfXAGH1FrvpkCaOeDKw?e=FOnSpd)
![](https://twitter.com/FigsFromPlums/status/1836163226284798038)
#### 背景
サイドオブジェクトはノイズの中から出てくるのを表現するために、拡大フェードインする際に、
背景のノイズ部分がオーバーレイとかで混ざるようにする。
![[EYEAREA豚岬背景案.jpg|400]]
## エンカウント
ボスの際は[[evilsearh]]をクリアするまではランダムでエンカウントする。
### エンカウント率
**cutareaごと**に一つ統一で決める、
敵リスト
### エンカウント処理
#### 倒した敵の死亡処理(非エンカウント処理)
エンカウントした敵がエンカウントしないよう登録するには
勝利した時に　　
元のstageデータベースに登録された敵を参照して、それをplayerstatusで
deadlistとして登録出来るようにする必要がある。　(idとか付与すればそれ比較で余裕か)
==ScriptableObject==の_enemyListを関数由来で変更、普通に別クラスから変更できるらしい。
その処理は敵の**種別**によって変わる→[[#復活の違い]]
### 敵集まりAI
数、組み合わせなどを属性、種別などの要素で決める。この結果が**パーティー属性になる。**
- 味方待機リストにサテラがいない場合
  ホッチキスは絶対にエンカウントしない。
#### 敵が一人の時のパーティー属性変換(キャラ属性→パーティー属性)
NormalEnemyのソースコードにある
#### 種別同士のエンカウント相性
NormalEnemyのソースコード部分
#### 属性同士の固定組み合わせによるパーティー属性変換(二人以上)
[[#精神属性]]同士の固定的な組み合わせによる[[#パーティー属性]]。
これになかった場合、[[#キャラクター属性同士のエンカウント相性値の表(敵)]]で判断。
この処理は出来れば相性値のロジックで複雑かつ思慮深く敵の関係性をパーティー属性で表したいから、==出来る事ならしたくない処理==,つまりここに**羅列されるものは相性値での算出結果としての目標でもある**。
- サイコ、シークイエスト、リーミナルホワイトタイル→オドラデクス

#### キャラクター属性同士のエンカウント相性値の表(敵)
##### 表のルール
- 列（1行目）の属性が**感じる側**、行（a列、一番左の列）の属性が**相性を感じられる側**として、それぞれの相性値をセルに入力します。非対称な相性値を持たせるため、行と列が逆の位置には違う値を入力します。
  例　リーミナル→キンダーガーデンの相性値はb3セルに
  キンダーガーデン→リーミナルの相性値はc2セルに。
- 同一属性は感じる側も感じられる側も同じだし、表の都合からいっても、一つだけ。
- 相性値は**感じられる側**を同じパーティに入れるときの判定なので、**百分率の数値**を入力。(integer)
##### 相性表(スプレッドシート)
https://docs.google.com/spreadsheets/d/13ri50fcdn-ikmkgt3gj9B5R9MLfwCZqgdozH3I7h1Pk/edit?usp=sharing

## メイン戦闘時ループ
~~あの世のように時間空けて敵の攻撃も実行される感じ?~~
スカイショットrpgのように>>を押して進む感じ。
後はキャラクターが選別される特定の戦いやその間離れてるキャラのエンカウントタイミングと
その瞬間の離人システム複数戦とか、そのタイミングを含めたの戦闘ループの設計調整が大事
→[[戦闘雑多]]

### クリティカル
クリティカル
### 乱雑する力
rpgフレーバー　乱雑する出力または乱雑する力  
攻撃のときにたまにランダム化してしまうがその代わりそのランダムの最大値が通常より大きい？  
つまりクリティカルの色違い？

### ぱーてぃか(運命の回転？)
#### 概要(発生条件)
**20ターンに1回、または誰かが死んだときに発生する。**　パーティー力。
**全体同士でラグビーみたいにスクラムするターン** 
であり、その発生条件の際に、==**お互いのグループが二人以上いないと反応しない==。**
戦闘開始時にお互いのグループに(ここでも二人以上判定がある。)50が上書きされる。

もし二人以上いるのに他が死亡判定になった状態で一人の状態から
→復活スキルで復活させて二人以上に戻った際、そのグループに50が上書きされる。
(<mark style="background: #FFB86CA6;">瀕死状態での決死の行動に捧ぐささやかな運命の動き</mark>)

#### 判断基準
彼らのぱーてぃか(数字)を比較し、
10以上数を超えて多い方に、報酬がもらえる
#### 報酬
[[#ランダムなターン制]]で  やや優位性がつく。
#### 意義
集団戦において、風の吹く向きが彼らの方向が変わることで影響される様子を
再現したい。
#### 敵のぱーてぃか
全員の**強さの連鎖**、HPで定義。
で上から並べて上から数えたときの、相性値(三人なら二つ、二人なら一つ)
で決まる。HPの定義はその時のHPです。(最大HPでも微妙に補正されるが、)
その**コンディション値**のHPの組み合わせによる全ての値を
並べて、それらと比較した際の度合いによる真ん中を境にした百分率の計算で、
ぱーてぃかが変わる。(60なら10上がり、40なら10下がる感じ)
##### 変動するとき
敵のぱーてぃかの変動は、敵のどのHPも88%以上でないとき、(この場合3ターンごとに+2)
また、同じHP+-4%でないときに。(この場合毎ターン+2)

つまり[[#敵集まりAI]]での==相性値はBattleGroupに保存==出来るようにする???
#### 味方のぱーてぃか
同じようなスキルを使い続けると、ぱーてぃかが下がる。
違う種類のスキルを使うと、ぱーてぃかは維持される。
その時と違うスキルに、ランダムターン(出ないターンもあるということ)
でぱーてぃか推奨スキル(運命補正の表示??)が映ることがあるので、その推奨スキルを使うと上がる。

### 戦闘最大人数
味方:最大3人(離人システムに応じて変わる)
敵:最大3人　(TLOAの性質と前のめりのできることを考慮すると、
この数がいい。)
敵同士の集まり方はそれぞれ個別に考える。
### 銭湯終了時のHP自動回復
離人システム含め、すべての戦闘が終わり歩行状態へ
移行する際、ターン数と食らったまたは与えたダメージをもとに計算して、回復する。?
### 回避率
戦闘初めは全員に基礎回避に加えて、初期ボーナスが与えられる(基礎回避依存。)
**初期ボーナスの効力は自分のターンが行使されるまでで**、
それ以降は普通にスキル依存の回避力になる。
具体的には直前にしたスキルの回避力が次まで続き続ける。

**回避段階に応じて==強制散開が発動==?**
完全回避(ノーダメージ)
かすり(割合少ないダメージ)
Hit
クリティカル(大Hit)

強制散開条件は
全員かすり以上なら
つまり上の四つの列挙体は**数で制御すれば処理が楽。**

かすりとクリティカルは同じ確率の2分の一??
### ランダムなターン制
確率がだんだん低くなる三回まで連続で選ばれる事がある。　
上に指標などを入れて駆け引き要素なども考えたが、**分からないように次の行動への何の指標も入れない。**
### ダウン
連続で攻撃を当てたときに、
ソイツのダウナーカウンタがゼロになったら、
ダウナーカウンタの半分　だけ、
ターンとして選ばれても何も行動できない。
追跡エネミーの場合はダウナーカウンタは
三分の一となり、ダウンさせると確定で逃げる。(強制)
### 散開と追跡システム
散開時のエフェクトはまずunitaskで散開エフェクトが終わるまで待って、
それから簡易マップのnowimgがスターダストみたいな効果音と拡大フェードアウトエフェクトで
消えて、赤点が周りに散らばってるって感じ。

追跡はいわゆる残存システム  
零　追跡はない　~~1一定時間集合不可~~  
二　散開したときに低確率で誰か追いつかれる

散開をした敵は次に散開して入れ替わるまで、
エンカウント率が超低下する。
**散開時はprogressは変わらずに固まり、その場の地点から**
**三点の赤いのが現在周辺から適当に散られる**。
ランダムで戻ってきて、現在地描画地点にある一定の大きさの
当たり判定の円に入ったらそいつから収束する。
収束するまでに逃げた敵以外のと逢ったりする。

==散開をさせてくる攻撃もある(即死レーザとか)==
### 幻覚効果  
月が見えるとその次の効果は皆にとって恐ろしいもの  
（散開ならバラけ方とか、離人戦闘ならそれとか、スキルなら単純に効果とか）  
[[天使の輪虫]]が見えると自分の次が素晴らしい効果。  
[[新生悪魔鳥]]だと自分に即座に良い効果が出た後に、  
敵にも確率で良い効果を満たすかも。  
（敵味方両方）
### 離人システム
複数のこじんせんなどがそれぞれの速さや  
回避率に応じて同時に展開される  
当然影響はしあわないが緊迫感がアル。  
  
これを散開時個人戦闘または  
誰かが個人戦闘中に発生するかも
### 命中
[[豚岬のプロセス具現]]にある、
~~ぽれんシステム　誰にあたるか分からない。~~
前のめりしない時に攻撃した際、
二つの選択肢がある。
前のめりした奴には確定で当たるが、(==回避率半減?==)
後衛に攻撃する際、二人のどちらかに当たるか分からない、
### 回避
~~全体回避率　全体の平均が全体の回避の処理。~~
~~失敗したら一番低い奴が選ばれやすい回避力ルーレットでそいつをだれかかばう、または~~
~~肩代わりまたは引っ張って除けさせる、~~
~~ここに回避防御傾向なども関わってくる？~~
三人しかおらずまた前のめりシステムもある為なし?
肩代わりとかは**スキルで実行すればいい。**
### BaseStatesuと攻撃エフェクトの同期
例えばatk関数にエフェクトと実際に実行される攻撃処理があって(r3でサブスクライブ？)これにターン数などを実行しmanager等で登録する形にすれば、後発的な攻撃の表現をエフェクトと一緒に実行できる
(ボタンを押した際に展開されて、atkがターン経ってから実行されると
エフェクトがアニメーションし消去? )
uniTaskの条件待ちでも行けると思う。
### 攻撃の当たり方
==基本的に前のターンで攻撃した奴が前のめりになり、次のターンで攻撃を受ける。==
前のめりはしなければ基本的に前回の前のめりが持続する。
### 前のめり
前のめりはランダムで**お互いのグループからそれぞれ一人**選ばれる。
#### 攻撃対象者例外
[[拳銃限られた銃弾]]は敵を選択する。(威力に違いはない。)
[[絶神術]]は全体攻撃で、後ろにいる奴のが食らう。
#### 前のめり例外
[[絶神術]]は指クイするから、前のめりしない。
[[拳銃限られた銃弾]]は前のめりを選択できる。前のめりした場合命中率が一律になる。
しなければ後ろの奴への命中率は半減する。
**それ以外は前のめりしないとダメージ与えられるわけないだろ。**

## ステータス
### 運用ステータス
レベルアップはせず、~~各ステータスがそれぞれ条件で上がっていく感じ。~~
歩いたりステージ進んだだけで上がったりもするかもね。
==永続的に上がったりすることはなく==、いわゆる運ゲーなのかもしれない。
**ただしHPだけ半端にちょっとずつ上がっていく。(経験値以外のシステムで)**
攻撃に命中などは**スキル依存**
##### 共通
HP P (キャラごとに複数あったりする?)　

名前の由来プロパティ（フレーバー要素）

リカバリターン(一回攻撃した後に、次のランダム敵選択リストに入り込むまでのターンカウンター、前のめり状態だと2倍の速度でカウントされる。)
##### 人間(種別)
気力(TLOAそのものではなく単独で動き、TLOAを展開させているから、
逆にビルから発生してるTLOA達はビルのエネルギで気力は常に補給され続けてるから、
TLOAそのものは一定。)
##### 実態生命
人間状況,、思えの値。

##### 新設悪魔部隊
HP経験値(歩行で溜まっていく、**逃走するたびに減っていく。**
それ以外で戦闘を終えても増える。)

### 特殊プロパティ
##### 飛行
##### 追跡
==**プロパティではなくPlayerStatesuに登録されるもの**==
==**として考える?**==
### オーラ系
炎のオーラとか、みたいな明らかな上書き属性。　弱点が存在しない。
[[正当な廃都市]]ステージだとやばいくらい強い敵だけど、
[[#豚岬]]のステージだと割りかし当たり前に出てくる。（悪魔多いから？）
ただし、豚岬だと今まで倒した敵のTLOAが使えるので、それでTLOA2 科学の鳥によるTLOAの物質的融合による強いアドバンテージでゴリ押す感じになる。
### 種別
##### 人間(実態生命)
**人間状況**がある。
##### TLOA
##### 機械

##### 人間以外の実態生命
人間と違う点は、**人間状況**はあるが、低レイヤーになるに応じて、
人間状況のカテゴリが基礎的なものしか存在せず、(==完全体rpgの性格天気補正みたいに全部に設定するか、クラスの継承で体系的に実装する。==)
さらに**思え**の値も知能が低いほど、最大値がクソ高い。(めったに思え鳥化なんかしないわ)

### 状態異常
そのキャラクターに現在突起的に起きてる事。
**状態異常のクラスそのものに**
**適合するプロパティを作り、**
**それが合い、発動条件クリアして渡されたら発動。**
つまり
- 発動条件(攻撃とかイベントとか)
- 相性条件(属性、種別など)
##### 新設悪魔部隊固有
＜オンケレイト>→[[リズミカル魂の開放]]
##### サテライト
<剝き出し>
思え鳥化する時に、たまに抵抗して、知能レイヤが下がり派生鳥の姿になる。
**スキルや彼女が関係する事柄などがすっかり変わる**(出来なくなる。)
##### 実体生命
<鬱病>
鬱病地区とかで移される。距離が延びる。

<思え鳥>
正体は[[精霊]]なので**属性攻撃**でたまる。
==その時の**人間状況**によって、どの**属性**が==
==その個人の思えの値を高めるかが決まる。==
例えば鬱病地区ならそういう奴らが多いからその彼らに対する特定の属性が彼らの思え鳥化を促進する。
**主人公たちはストーリーによって状況が決まる(分岐しないので固定)**　それ以外に
**例えば鬱病地区にて<鬱病>を移されたりしたら、人間状況がそっちに傾き、対鬱病の属性による思え化が進みやすくなる。**
主人公らは累積だが、敵は初期値はランダムで決まる。

サテライトは派生鳥の一種なので、→[[キャラ設定]]
(Linuxのディストリビューションみたいな)
思え鳥に抵抗して、たまに<剥き出し>で
派生鳥になる。もとの姿。
### 属性
相関するというよりはそれぞれのスキルにそれぞれの耐性とか得意が設定できる感じ
つまりその**スキルを使えば使うほど、そのスキルの耐性にキャラクターが近づいていく**
また、属性ごとに人間状況に対する　精神影響の相性がある。
以下の細かい属性一覧は
キャラクターとパーティー以外は
スキルに依存する
#### パーティー属性
- 馬鹿共
- メレーンズ
- 聖戦
- オドラデクス
- 花樹

味方陣と敵陣の属性などの組み合わせ
で決まる　二つのチームがそれぞれ持つもの。
##### 味方の決まるロジック
<mark style="background: #FFB86CA6;">HPの組み合わせ</mark>で決める
この意義は?
→プレイヤーの選んだ選択によって、変化してほしい。
**ステータスとしての成長要素は最大HPのみ**だから、
全員万全状態でも差異が生じる。それでもパーティー属性は==現在HP==で決まるから、
ちゃんと状況による差異も生じてくれる。
#### 物理属性
種別または特殊プロパティまたは
個別で手動にこれに対する耐性を設定?

#### キャラクター属性
直前のスキルの精神属性に影響
敵の初期精神属性は、
自分でStageデータベースから彼らの持ってるスキル
から見つかった精神属性リストが自動で並ぶので、
プルダウンでその中から探す。
**ランダムではない**

例えば、**気後れ**なんてパッシブを持ってる奴なら、
このスキルが自らのキャラクター属性に取って代わるのが
2ターン遅れたりするかもしれない
#### 精神属性
攻撃対象のキャラクター属性と嚙み合う

- リーミナルホワイトタイル
- キンダーガーデン
- 自己犠牲
- シークイエスト
- デビル
- ドレミス
- 支柱
- ゴッドティア
- ベールドライヴァル
- サイコパス


### 人間状況(実態生命全てに体系的に適用)
状態異常などで傾いたり、変わらないエリア固定値などによって変化したり、
複雑な値で決まる固定値

### 思えの値
**人間状況があるキャラのみにある。**
maxになると<思え鳥>化
**種別*など*のそのキャラそのものの知能によって**
**大きさが違う。**
==ぶっちゃけ手動設定でいいと思う。==
##### 上昇条件
人間状況に対する属性の通りやすさ
{耐性}人間状況　{攻撃}属性
**キャラ自体の属性は関わらない。**(キャラ属性VS攻撃属性はHPに対するダメージ)


## スキル
- [[着火]] 　[[魔素７２分割]]で貴重なため敵限定　味方はマ体のみが魔法スキル
- [[#雨光槍]]　雨が降ってるときに使える。
雨の中で光を激しく反響させてレーザーを打つ
### パッシブスキル
多分ほとんど実装しない、
理論論理の為だけかな。

[[安定海の理論論理]]
### TLOAの相性
例えば[[安定海の理論論理]]（パッシブスキル名）ってのがあったとして、**彼らは[[TLOA]]を知っているだろうから**、（詳細はリンク先）
例えばあるtloaが[[量産型TLOA]]だったら、
それに対し、「量産された思考が真の思考に勝てるはずがない」と信じ切ってるキャラに対する攻撃はかなり半減される、みたいな？

==つまり完全に個人的なあれだからユニークな実装が必要だわ==

## アイテム
### 武器系（これいるか？）
これらは使用すると武器枠を上書きする。
##### サンミのロッド　
武器枠がサンミロッドになる

## 敵
敵はシステム上ステージのデータにリストとしてに蓄積される。
### [[#種別]]ごとの違い
#### 復活の違い
ただ一人=敵のシステムは回復地点と相性悪い。
だから**復活するかしないかの種別で分けたり、リスト内で意図的に重複させて**調節すればいい。

TLOAのキャラクターは一度倒しても消えない。
生命キャラは倒したら消えるが、特定の歩数で復活?

機械キャラは倒したら消える。
**結局敵の標準クラスに復活歩数プロパティ付けて
調節するから手動**
未復活の時はStageクラスで未出現リストに入れて
歩数処理すればいいだけ。　[[#倒した敵の死亡処理(非エンカウント処理)]]



### 裏切り
主人公はラスト
マ体はマ体の暴走(左半身消失)
~~同僚は思え鳥化~~(思え鳥は全員?)
### 敵たち
#### [[路人]]
倒した際にそいつらのhpは自分にくっつけられる。回復しない最大hpとして。
**主人公単体戦**で、下手したら他の敵と全体戦中に茶々入れてくる時もいる。
#### ホッチキス(追跡残党)
**同僚単体戦**　周りの二人は逃げる
ホッチキスに乗って襲ってきます
三人乗りホッチキス
　四人乗りホッチキス　人数効果で強さ、一人乗りが一番強いけど
　==こいつに会うたび同僚関係の深堀会話が進む???==
#### 悪魔に使役される武器のTLOAの奴ら(汎用強敵)
敵　首に剣が刺さってて、**抜いてそれを使うのが変身扱いで**  
**グラフィック変わる奴**　  
こういう感じで武器のTLOAがたまに出てきて、  
それぞれ剣人　槍人　エフィリー人(視線攻撃)　四つ足機械人  (床ずれ防御高め)
全員首からそれを抜く人体である。(豚争い　敵の章に書く  
豚岬では極魔道式敵グラ退陣はしない

#### 雪だるまのTLOA小
第一ステージで雪がやまない際の原因
倒すと永遠に降ることはなくなる。
#### 禍つ明のTLOA
持ち主の男の名前が強すぎてTLOAの名前すら消えてしまったTLOA


## 雑多システム
[[リズミカル魂の開放]]
- 逃走確率は確定40%
- セーブは[[ノーツのTLOA]]から随時行えます。
##### あの世と全く同じアイテムシステム
##### hddを重くすることで使えるアイテム欄
![[簡易雑多#hdd（ヘヴィーディスクドライブ）]]
この仕組みというテキストを元に、
重量が重ければ重いほどアイテムに物を入れられていくような感じで。
あの世と同じように使用はターンなどに制限されず、限られていて使用効果も少ないものなど。(==あの世みたいに枯渇すると死ぬエネルギーはないよ。散々要素たくさんあるけど。==)

これらアイテムは[[正当な廃都市|閉都市]]から生まれたアイデアがそこら中を
[[天球インターネットワーク]]の要領で浮いたりしてるって言う設定で、
TLOAが強く固まりやすいみたいなあれで、アイテム化している。
**PlayerStatesで管理**
##### ui遷移
ランダムターン制であの世みたいに全員のスキルボタンが戦闘状態でなくても常に出てて、
それで空振りもできる。(**Pを消費するなら当然消費します。**)
外で振っても意味あるかも。

この機能の目的
[[リズミカル魂の開放]]であの世では剣ボタンがそのまま光るけど、
それをこのゲームでも実装するためと考えたが、別にキャラクターステージステータス光らせればいけるかも

**EyeAreaにあるキャラクターのアイコンがあの世の剣に互換して光る。**
~~USERUIのとこの各人のスキルも点滅?~~
USERUIのところは**雪道のboss時の表示みたいに**、太い字が絵の上にあるから、
それが元ネタと同じように震える。

USERUIのボタンは雪道のboss太字風だが、

##### ステージ間の雪道風ストーリ
[[正当な廃都市|閉都市]]の完成するまでのストーリ入れる?????　[[豚のシナリオ]]
==または全体的な主人公当たりのスケールを飛び越えるようなストーリ==
最初だけイントロ? [[信仰型TLOA]]と[[量産型TLOA]]の違いとミサについても???いやそれは会話内容に入れるか???
![[豚岬#二百年チップ（仮） と 正当な廃都市 の生み出された経緯]]
##### パズル
次にエンカウントするまでに、**パズル**を解いて、防御力の低下を防ぐ。
防御力自体は戦闘すればするほど高まっていくが、(防御発生確率?)
歩行するごとに下がっていく、それを**パズル**で上げていく。
高確率ランダムで現れる道端にあるパズル要素を解いていく。
==アイテムがいっぱいあるほど有利になる。==
アイテムにパズルのヒントや、そもそもパズルの分かりやすさ＝持ってるアイテムの数や内容に
寄るようにするといいかも。
[[#逆文字収集]]で行う？
##### 歩行速度
歩行する速度が速ければ早いほど、**先手を取る確率**が高まる。
蓄積しない。(==明記しないシステム?==)
## プレイアブル
挙げられている者たちはあくまで**カテゴリ**それぞれの中に複数のスキルが内包されている。
#### 主人公
[[TLOA汎受性]]、[[拳銃限られた銃弾]]、[[武器主六面の魂]] 、[[恋愛兵器CZ]](弱いランダム攻撃?)
#### マ体
連鎖的な[[述]]([[絶神術]])　[[拳銃限られた銃弾]]、ミサ(TLOA)
マ体で肉体部分死んでも死なないから、このキャラだけは肉体が死んでも一部の技が使えるし、
全滅したらこいつが連れ戻す。
**物理技で二分の一で食らわない代わりに常人の二分の一しか**
**HPがない。**
魔法を食らったら彼の弱いマ体など即吹き飛ぶが、
うれしいことに本作はそんなキャラおらんから、平気。
##### ミサとは
**パズル要素**　兼　通常攻撃


#### 同僚
ワープ術(ストレイクト,)　 [[拳銃限られた銃弾]]　[[パーソナルイドラクト]](ホッチキス戦の時のみ)

## ステージ
[[正当な廃都市]]→草原→豚岬
休憩地点がそれぞれあって、それぞれに絵があり、
さらに休憩地点で区切られた通常のゾーンごとに、絵の違いがある。
### 休憩地点
#### 魔式陣の展開
マ体の再生するには 以下のような**魔式陣の展開**が必要ですよん
[[魔素７２分割]]が起こってるからね。
![](https://twitter.com/DannyDrinksWine/status/1825977351190229101)
### 仕組み
ステージは分岐前とか分岐後の分かれ目数本で**エリア**として分ける
プログラム上ではStageCutとして。
このStagecutにlistでAreadataをまとめて一歩一個ずつ解釈する。
そのareadataに選択肢のデータとしてエリアのIDを指定し、
そのエリアに移ったりできる。
### ステージステータス
新設悪魔部隊たちの、**ステージステータスボーナス**
これはHP以外の全ての値に適用される。ステージごとに違う。
逆に言うとステータスはHPしか上がらない。

### 鬱病地区
雪の剣の影響で[[正当な廃都市]]の鬱病地区があるが、そこで鬱病のTLOAに伝染すると、
ノンフィールドrpgとしての距離が伸びる、直ると距離戻る。
つーかまぁ鬱状態直るまで永遠フリー歩かされて、解決するといつものステージシステムに戻る感じ、**特定ステージでの永遠解消までのシステムが大事ですわ**

### 豚岬
多分倒した奴のTLOAを使って攻略する。
オーラ系がクソ多いと思う
### クリア後
なんか今まで出てた敵のうちのどれかが
自分の過去と繋がってて
そのまま過去に影響与えるステージをちょっとだけプレイするみたいな。
雪道みたいに条件ないと入れない？
#### 主人公が[[エディアカラ]]に書かれた展開。
==アーチが無くなった事によって
[[魂的な逆行]]が起こる。==
もとよりアーチに仕込んであったそれが後発的展開を迎えた感じ。
### 休憩地点
HPや銃弾の全回復、[[ノーツのTLOA]]の使用
(銃弾の全回復には色々条件等あるかもしれない。)
### 現在地点
散開時に花の画像に切り替わったり、
歩いて先手が取れる時間の間に点滅したりとかする。
## 天気

### 雨
#### 雨光槍
- 光のオーラ系を持ったユニット
- 光要素のあるユニークな技
のどちらは単独または併発で
雨光槍を打てる
#### 超絶雷雨
## 設定項目
#### 会話無効
ストーリー上、[[路人]]とかの会話要素をすべて省く。
会話イベントを全て一つの完結するクラスで扱った上で、
この設定は使えるようになると思う。
## 最適化
[【Unity】TextMeshProの容量を指定した文字だけ入れて減らす手順 - はなちるのマイノート (hanachiru-blog.com)](https://www.hanachiru-blog.com/entry/2021/05/27/120000)





